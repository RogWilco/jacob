{
  "action": "created",
  "issue": {
    "url": "https://api.github.com/repos/kleneway/jacob/issues/51",
    "repository_url": "https://api.github.com/repos/kleneway/jacob",
    "labels_url": "https://api.github.com/repos/kleneway/jacob/issues/51/labels{/name}",
    "comments_url": "https://api.github.com/repos/kleneway/jacob/issues/51/comments",
    "events_url": "https://api.github.com/repos/kleneway/jacob/issues/51/events",
    "html_url": "https://github.com/kleneway/jacob/pull/51",
    "id": 2384945724,
    "node_id": "PR_kwDOME9Q9M50IUGM",
    "number": 51,
    "title": "JACoB PR for Issue Add image upload to send screenshot data to the chat",
    "user": {
      "login": "jacob-local-kevin[bot]",
      "id": 164088400,
      "node_id": "BOT_kgDOCcfKUA",
      "avatar_url": "https://avatars.githubusercontent.com/u/542289?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D",
      "html_url": "https://github.com/apps/jacob-local-kevin",
      "followers_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacob-local-kevin%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2024-07-02T00:10:29Z",
    "updated_at": "2024-07-02T16:30:16Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "draft": true,
    "pull_request": {
      "url": "https://api.github.com/repos/kleneway/jacob/pulls/51",
      "html_url": "https://github.com/kleneway/jacob/pull/51",
      "diff_url": "https://github.com/kleneway/jacob/pull/51.diff",
      "patch_url": "https://github.com/kleneway/jacob/pull/51.patch",
      "merged_at": null
    },
    "body": "## Changes Performed:\n\n### Step 1: Create ImageUploader Component\n\n## Files: src/app/dashboard/[org]/[repo]/[developer]/components/chat/ImageUploader.tsx\n\n## Details: 1. Import necessary hooks and components from React, including `useState` for managing state.\n2. Define a new functional component `ImageUploader` that will handle the image upload process.\n3. Inside the component, use `useState` to manage the loading state and the list of uploaded image URLs.\n4. Implement a function `handleFileSelect` that opens the file picker dialog and allows users to select multiple images. Use the `input` element with `type='file'` and set `multiple` attribute to true.\n5. Validate the selected files within `handleFileSelect` based on the requirements (under 20MB and either PNG or JPEG). Use toast notifications for error handling.\n6. For valid files, send them to the `/api/image/upload` API endpoint. Use `fetch` to make POST requests with the image data. Handle the response by updating the state with the new image URLs and displaying a success toast notification.\n7. Render the `ImageUploader` component within `ChatInput`, including a button to trigger file selection and a visual indicator for the loading state.\n\n## Exit CriteriaImageUploader component created with file selection, validation, API interaction, and state management.\n\n### Step 2: Modify ChatInput to Include Image Upload\n\n## Files: src/app/dashboard/[org]/[repo]/[developer]/components/chat/ChatInput.tsx\n\n## Details: 1. Import the `ImageUploader` component.\n2. Add the `ImageUploader` component to the `ChatInput` component, positioning it to the left of the send message button.\n3. Ensure the upload button is styled consistently with other buttons in the chat interface using Tailwind CSS.\n4. Update the `onSend` function to include the URLs of uploaded images when sending a chat message. This may involve modifying the message object structure to include an `images` property containing the image URLs.\n\n## Exit CriteriaChatInput component modified to include the ImageUploader component and handle image URLs in chat messages.\n\n### Step 3: Update Chat Component for Displaying Images\n\n## Files: src/app/dashboard/[org]/[repo]/[developer]/components/chat/Chat.tsx\n\n## Details: 1. Modify the `ChatMessage` component to render images if the message includes image URLs. Use `img` tags for displaying each image within the chat bubble.\n2. Ensure images are displayed correctly, maintaining the existing chat message styles. Use Tailwind CSS for styling as needed.\n3. Update the `Chat` component to pass any necessary props to `ChatMessage` for image display.\n\n## Exit CriteriaChat and ChatMessage components updated to display uploaded images within chat messages.\n\n### Step 4: Add File Size Validation to API Endpoint\n\n## Files: src/app/api/image/upload/route.ts\n\n## Details: 1. Modify the `POST` function in `src/app/api/image/upload/route.ts` to include validation for the image file size, ensuring it does not exceed 20MB.\n2. Use the existing error handling pattern to return an appropriate error response if the validation fails.\n3. Ensure the API continues to handle image type validation and uploading to S3 as before.\n\n## Exit CriteriaAPI endpoint updated to validate image file size and return an error for files exceeding 20MB.\n\n### Step 5: Update Global Styles for Image Upload Button\n\n## Files: src/styles/globals.css\n\n## Details: 1. Add necessary styles for the new image upload button in `src/styles/globals.css`. Ensure the button is consistent with the chat interface's design theme.\n2. Include styles for the visual loading indicator on the upload button during the image upload process. Use Tailwind CSS for styling.\n3. Ensure the uploaded images are styled correctly when displayed in the chat messages.\n\n## Exit CriteriaGlobal styles updated to include styles for the image upload button and uploaded images in chat.## Changes Performed:\n\n### Step 1: Fix ImageUploader Syntax Error\n\n## Files: src/app/dashboard/[org]/[repo]/[developer]/components/chat/ImageUploader.tsx\n\n## Details: Remove the diff syntax (---, +++, @@, etc.) from the beginning of the file. The file should start directly with the import statements and continue with the rest of the React component code as intended. This will resolve the syntax errors related to the diff syntax being present in the actual code file.\n\n## Exit CriteriaThe ImageUploader.tsx file should no longer contain diff syntax and should be a valid TypeScript React component.\n\n### Step 2: Correct Variable Reassignment in Upload Route\n\n## Files: src/app/api/image/upload/route.ts\n\n## Details: Change the declaration of `imageBuffer` from `const` to `let` before its first assignment. This allows `imageBuffer` to be reassigned later in the code if `shouldResize` is true, resolving the 'cannot reassign to a variable declared with `const`' error.\n\n## Exit CriteriaThe imageBuffer variable can be reassigned within the upload route, allowing for image resizing functionality to work correctly.## Changes Performed:\n\n### Step 1: Fix TypeScript and ESLint issues in ImageUploader.tsx\n\n## Files: src/app/dashboard/[org]/[repo]/[developer]/components/chat/ImageUploader.tsx\n\n## Details: 1. Remove the unused variable 'uploadedUrls' or implement its usage if intended for future features.\n2. Replace the `for` loop with a `for-of` loop for iterating over files to upload. This change addresses the ESLint warning for preferring `for-of` loops.\n3. Add explicit type annotations to variables and function parameters to avoid 'any' type assignments and arguments. Ensure that all variables and function parameters related to file handling and image processing are correctly typed.\n4. If necessary, import any missing types or utilities needed for explicit typing.\n\n## Exit CriteriaThe TypeScript errors related to 'any' types and the ESLint warnings/errors about unused variables and loop preferences are resolved.\n\n### Step 2: Resolve TypeScript error in Chat.tsx\n\n## Files: src/app/dashboard/[org]/[repo]/[developer]/components/chat/Chat.tsx\n\n## Details: 1. Add explicit type annotations to variables or function parameters that are currently implicitly typed as 'any'. This may involve importing types or interfaces that describe the data structure of chat messages or user information.\n2. Review the context in which the unsafe assignment occurs and ensure that the data being assigned is properly typed or cast to the expected type with adequate runtime checks if necessary.\n\n## Exit CriteriaThe TypeScript error related to unsafe assignment of an 'any' value is resolved.\n\n@jacob-ai-bot fix error\n\n## Error Message:\n```\nCommand failed: __NEXT_TEST_MODE=1 SKIP_ENV_VALIDATION=1 npm run build --verbose && npx tsc --noEmit\nnpm verb cli /Users/kleneway/.nvm/versions/node/v20.10.0/bin/node /Users/kleneway/.nvm/versions/node/v20.10.0/bin/npm\nnpm info using npm@10.2.3\nnpm info using node@v20.10.0\nnpm verb title npm run build\nnpm verb argv \"run\" \"build\" \"--loglevel\" \"verbose\"\nnpm verb logfile logs-max:10 dir:/Users/kleneway/.npm/_logs/2024-07-02T00_10_22_792Z-\nnpm verb logfile /Users/kleneway/.npm/_logs/2024-07-02T00_10_22_792Z-debug-0.log\nnpm verb cli /Users/kleneway/.nvm/versions/node/v20.10.0/bin/node /Users/kleneway/.nvm/versions/node/v20.10.0/lib/node_modules/npm/bin/npm-cli.js\nnpm info using npm@10.2.3\nnpm info using node@v20.10.0\nnpm verb title npm run build:1-next\nnpm verb argv \"run\" \"build:1-next\"\nnpm verb logfile logs-max:10 dir:/Users/kleneway/.npm/_logs/2024-07-02T00_10_23_092Z-\nnpm verb logfile /Users/kleneway/.npm/_logs/2024-07-02T00_10_23_092Z-debug-0.log\n\nFailed to compile.\n\n./src/app/dashboard/[org]/[repo]/[developer]/components/chat/Chat.tsx\n55:21  Error: Unsafe assignment of an `any` value.  @typescript-eslint/no-unsafe-assignment\n\n./src/app/dashboard/[org]/[repo]/[developer]/components/chat/ImageUploader.tsx\n54:15  Error: Unsafe assignment of an `any` value.  @typescript-eslint/no-unsafe-assignment\n55:22  Error: Unsafe argument of type `any` assigned to a parameter of type `string`.  @typescript-eslint/no-unsafe-argument\n\ninfo  - Need to disable some ESLint rules? Learn more here: https://nextjs.org/docs/basic-features/eslint#disabling-rules\nnpm verb exit 1\nnpm verb code 1\nERROR: \"build:1-next\" exited with 1.\nnpm verb exit 1\nnpm verb code 1\n\n```",
    "reactions": {
      "url": "https://api.github.com/repos/kleneway/jacob/issues/51/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/kleneway/jacob/issues/51/timeline",
    "performed_via_github_app": null,
    "state_reason": null
  },
  "comment": {
    "url": "https://api.github.com/repos/kleneway/jacob/issues/comments/2203779237",
    "html_url": "https://github.com/kleneway/jacob/pull/51#issuecomment-2203779237",
    "issue_url": "https://api.github.com/repos/kleneway/jacob/issues/51",
    "id": 2203779237,
    "node_id": "IC_kwDOME9Q9M6DWwCl",
    "user": {
      "login": "kleneway",
      "id": 542289,
      "node_id": "MDQ6VXNlcjU0MjI4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/542289?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kleneway",
      "html_url": "https://github.com/kleneway",
      "followers_url": "https://api.github.com/users/kleneway/followers",
      "following_url": "https://api.github.com/users/kleneway/following{/other_user}",
      "gists_url": "https://api.github.com/users/kleneway/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kleneway/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kleneway/subscriptions",
      "organizations_url": "https://api.github.com/users/kleneway/orgs",
      "repos_url": "https://api.github.com/users/kleneway/repos",
      "events_url": "https://api.github.com/users/kleneway/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kleneway/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-07-02T16:30:16Z",
    "updated_at": "2024-07-02T16:30:16Z",
    "author_association": "OWNER",
    "body": "@jacob-ai-bot fix error\r\n\r\nError Message:\r\nCommand failed: __NEXT_TEST_MODE=1 SKIP_ENV_VALIDATION=1 npm run build --verbose && npx tsc --noEmit\r\nnpm verb cli /Users/kleneway/.nvm/versions/node/v20.10.0/bin/node /Users/kleneway/.nvm/versions/node/v20.10.0/bin/npm\r\nnpm info using npm@10.2.3\r\nnpm info using node@v20.10.0\r\nnpm verb title npm run build\r\nnpm verb argv \"run\" \"build\" \"--loglevel\" \"verbose\"\r\nnpm verb logfile logs-max:10 dir:/Users/kleneway/.npm/_logs/2024-07-02T00_10_22_792Z-\r\nnpm verb logfile /Users/kleneway/.npm/_logs/2024-07-02T00_10_22_792Z-debug-0.log\r\nnpm verb cli /Users/kleneway/.nvm/versions/node/v20.10.0/bin/node /Users/kleneway/.nvm/versions/node/v20.10.0/lib/node_modules/npm/bin/npm-cli.js\r\nnpm info using npm@10.2.3\r\nnpm info using node@v20.10.0\r\nnpm verb title npm run build:1-next\r\nnpm verb argv \"run\" \"build:1-next\"\r\nnpm verb logfile logs-max:10 dir:/Users/kleneway/.npm/_logs/2024-07-02T00_10_23_092Z-\r\nnpm verb logfile /Users/kleneway/.npm/_logs/2024-07-02T00_10_23_092Z-debug-0.log\r\n\r\nFailed to compile.\r\n\r\n./src/app/dashboard/[org]/[repo]/[developer]/components/chat/Chat.tsx\r\n55:21  Error: Unsafe assignment of an `any` value.  @typescript-eslint/no-unsafe-assignment\r\n\r\n./src/app/dashboard/[org]/[repo]/[developer]/components/chat/ImageUploader.tsx\r\n54:15  Error: Unsafe assignment of an `any` value.  @typescript-eslint/no-unsafe-assignment\r\n55:22  Error: Unsafe argument of type `any` assigned to a parameter of type `string`.  @typescript-eslint/no-unsafe-argument\r\n\r\ninfo  - Need to disable some ESLint rules? Learn more here: https://nextjs.org/docs/basic-features/eslint#disabling-rules\r\nnpm verb exit 1\r\nnpm verb code 1\r\nERROR: \"build:1-next\" exited with 1.\r\nnpm verb exit 1\r\nnpm verb code 1",
    "reactions": {
      "url": "https://api.github.com/repos/kleneway/jacob/issues/comments/2203779237/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  "repository": {
    "id": 810504436,
    "node_id": "R_kgDOME9Q9A",
    "name": "jacob",
    "full_name": "kleneway/jacob",
    "private": false,
    "owner": {
      "login": "kleneway",
      "id": 542289,
      "node_id": "MDQ6VXNlcjU0MjI4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/542289?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kleneway",
      "html_url": "https://github.com/kleneway",
      "followers_url": "https://api.github.com/users/kleneway/followers",
      "following_url": "https://api.github.com/users/kleneway/following{/other_user}",
      "gists_url": "https://api.github.com/users/kleneway/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kleneway/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kleneway/subscriptions",
      "organizations_url": "https://api.github.com/users/kleneway/orgs",
      "repos_url": "https://api.github.com/users/kleneway/repos",
      "events_url": "https://api.github.com/users/kleneway/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kleneway/received_events",
      "type": "User",
      "site_admin": false
    },
    "html_url": "https://github.com/kleneway/jacob",
    "description": "Just Another Coding Bot",
    "fork": true,
    "url": "https://api.github.com/repos/kleneway/jacob",
    "forks_url": "https://api.github.com/repos/kleneway/jacob/forks",
    "keys_url": "https://api.github.com/repos/kleneway/jacob/keys{/key_id}",
    "collaborators_url": "https://api.github.com/repos/kleneway/jacob/collaborators{/collaborator}",
    "teams_url": "https://api.github.com/repos/kleneway/jacob/teams",
    "hooks_url": "https://api.github.com/repos/kleneway/jacob/hooks",
    "issue_events_url": "https://api.github.com/repos/kleneway/jacob/issues/events{/number}",
    "events_url": "https://api.github.com/repos/kleneway/jacob/events",
    "assignees_url": "https://api.github.com/repos/kleneway/jacob/assignees{/user}",
    "branches_url": "https://api.github.com/repos/kleneway/jacob/branches{/branch}",
    "tags_url": "https://api.github.com/repos/kleneway/jacob/tags",
    "blobs_url": "https://api.github.com/repos/kleneway/jacob/git/blobs{/sha}",
    "git_tags_url": "https://api.github.com/repos/kleneway/jacob/git/tags{/sha}",
    "git_refs_url": "https://api.github.com/repos/kleneway/jacob/git/refs{/sha}",
    "trees_url": "https://api.github.com/repos/kleneway/jacob/git/trees{/sha}",
    "statuses_url": "https://api.github.com/repos/kleneway/jacob/statuses/{sha}",
    "languages_url": "https://api.github.com/repos/kleneway/jacob/languages",
    "stargazers_url": "https://api.github.com/repos/kleneway/jacob/stargazers",
    "contributors_url": "https://api.github.com/repos/kleneway/jacob/contributors",
    "subscribers_url": "https://api.github.com/repos/kleneway/jacob/subscribers",
    "subscription_url": "https://api.github.com/repos/kleneway/jacob/subscription",
    "commits_url": "https://api.github.com/repos/kleneway/jacob/commits{/sha}",
    "git_commits_url": "https://api.github.com/repos/kleneway/jacob/git/commits{/sha}",
    "comments_url": "https://api.github.com/repos/kleneway/jacob/comments{/number}",
    "issue_comment_url": "https://api.github.com/repos/kleneway/jacob/issues/comments{/number}",
    "contents_url": "https://api.github.com/repos/kleneway/jacob/contents/{+path}",
    "compare_url": "https://api.github.com/repos/kleneway/jacob/compare/{base}...{head}",
    "merges_url": "https://api.github.com/repos/kleneway/jacob/merges",
    "archive_url": "https://api.github.com/repos/kleneway/jacob/{archive_format}{/ref}",
    "downloads_url": "https://api.github.com/repos/kleneway/jacob/downloads",
    "issues_url": "https://api.github.com/repos/kleneway/jacob/issues{/number}",
    "pulls_url": "https://api.github.com/repos/kleneway/jacob/pulls{/number}",
    "milestones_url": "https://api.github.com/repos/kleneway/jacob/milestones{/number}",
    "notifications_url": "https://api.github.com/repos/kleneway/jacob/notifications{?since,all,participating}",
    "labels_url": "https://api.github.com/repos/kleneway/jacob/labels{/name}",
    "releases_url": "https://api.github.com/repos/kleneway/jacob/releases{/id}",
    "deployments_url": "https://api.github.com/repos/kleneway/jacob/deployments",
    "created_at": "2024-06-04T20:32:18Z",
    "updated_at": "2024-06-04T20:42:39Z",
    "pushed_at": "2024-07-02T00:10:30Z",
    "git_url": "git://github.com/kleneway/jacob.git",
    "ssh_url": "git@github.com:kleneway/jacob.git",
    "clone_url": "https://github.com/kleneway/jacob.git",
    "svn_url": "https://github.com/kleneway/jacob",
    "homepage": "https://jacb.ai",
    "size": 2281,
    "stargazers_count": 0,
    "watchers_count": 0,
    "language": null,
    "has_issues": true,
    "has_projects": true,
    "has_downloads": true,
    "has_wiki": true,
    "has_pages": false,
    "has_discussions": false,
    "forks_count": 0,
    "mirror_url": null,
    "archived": false,
    "disabled": false,
    "open_issues_count": 42,
    "license": {
      "key": "apache-2.0",
      "name": "Apache License 2.0",
      "spdx_id": "Apache-2.0",
      "url": "https://api.github.com/licenses/apache-2.0",
      "node_id": "MDc6TGljZW5zZTI="
    },
    "allow_forking": true,
    "is_template": false,
    "web_commit_signoff_required": false,
    "topics": [],
    "visibility": "public",
    "forks": 0,
    "open_issues": 42,
    "watchers": 0,
    "default_branch": "main"
  },
  "sender": {
    "login": "kleneway",
    "id": 542289,
    "node_id": "MDQ6VXNlcjU0MjI4OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/542289?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kleneway",
    "html_url": "https://github.com/kleneway",
    "followers_url": "https://api.github.com/users/kleneway/followers",
    "following_url": "https://api.github.com/users/kleneway/following{/other_user}",
    "gists_url": "https://api.github.com/users/kleneway/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kleneway/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kleneway/subscriptions",
    "organizations_url": "https://api.github.com/users/kleneway/orgs",
    "repos_url": "https://api.github.com/users/kleneway/repos",
    "events_url": "https://api.github.com/users/kleneway/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kleneway/received_events",
    "type": "User",
    "site_admin": false
  },
  "installation": {
    "id": 48653147,
    "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uNDg2NTMxNDc="
  }
}
